<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Drishyamitra â€“ {{ tab|capitalize }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="auth-body">

  <div class="auth-wrapper">
    <!-- LEFT PANEL -->
    <div class="auth-left">
      <a href="{{ url_for('main.landing') }}" class="auth-logo">
        <span class="brand-icon">ğŸ‘ï¸</span>
        <span class="brand-name">Drishyamitra</span>
      </a>
      <div class="auth-left-content">
        <h2>AI-Powered Photo Management</h2>
        <p>Upload once. Let AI organize everything automatically.</p>
        <ul class="auth-perks">
          <li>âœ… Auto face detection & folder creation</li>
          <li>âœ… One photo â†’ multiple person folders</li>
          <li>âœ… Natural language AI assistant</li>
          <li>âœ… One-click email delivery</li>
        </ul>
      </div>
      <div class="auth-left-footer">
        Â© 2024 Drishyamitra Â· AI Photo Management
      </div>
    </div>

    <!-- RIGHT PANEL: forms -->
    <div class="auth-right">

      <!-- Flash messages -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for cat, msg in messages %}
          <div class="flash flash-{{ cat }}">{{ msg }}</div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <!-- â”€â”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
      {% if tab != 'reset' %}
      <div class="auth-tabs">
        <button class="auth-tab {% if tab == 'login' %}active{% endif %}"
                onclick="switchTab('login')">Log In</button>
        <button class="auth-tab {% if tab == 'signup' %}active{% endif %}"
                onclick="switchTab('signup')">Sign Up</button>
      </div>
      {% endif %}

      <!-- â•â• LOGIN FORM â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="tab-login" class="auth-form-wrapper {% if tab == 'login' %}visible{% endif %}">
        <h2 class="form-title">Welcome back ğŸ‘‹</h2>
        <p class="form-subtitle">Log in to your Drishyamitra account.</p>
        <form action="{{ url_for('auth.login') }}" method="POST" class="auth-form">
          <div class="form-group">
            <label>Email Address</label>
            <input type="email" name="email" placeholder="you@example.com" required autocomplete="email">
          </div>
          <div class="form-group">
            <label>Password</label>
            <div class="input-eye">
              <input type="password" name="password" id="login-pwd" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
              <button type="button" class="eye-btn" onclick="togglePwd('login-pwd',this)">ğŸ‘ï¸</button>
            </div>
          </div>
          <div class="form-row">
            <label class="checkbox-label">
              <input type="checkbox"> Remember me
            </label>
            <a href="{{ url_for('auth.forgot_password') }}" class="link-sm">Forgot password?</a>
          </div>
          <button type="submit" class="btn-primary btn-full">Log In</button>
        </form>
        <p class="form-switch">
          Don't have an account?
          <a href="#" onclick="switchTab('signup')">Sign up free</a>
        </p>
      </div>

      <!-- â•â• SIGNUP FORM â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="tab-signup" class="auth-form-wrapper {% if tab == 'signup' %}visible{% endif %}">
        <h2 class="form-title">Create Account ğŸš€</h2>
        <p class="form-subtitle">Join Drishyamitra and start organizing photos with AI.</p>
        <form action="{{ url_for('auth.signup') }}" method="POST" class="auth-form">
          <div class="form-group">
            <label>Full Name</label>
            <input type="text" name="full_name" placeholder="Your full name" required>
          </div>
          <div class="form-group">
            <label>Email Address</label>
            <input type="email" name="email" placeholder="you@example.com" required autocomplete="email">
          </div>
          <div class="form-group">
            <label>Password</label>
            <div class="input-eye">
              <input type="password" name="password" id="signup-pwd" placeholder="Min. 6 characters" required>
              <button type="button" class="eye-btn" onclick="togglePwd('signup-pwd',this)">ğŸ‘ï¸</button>
            </div>
          </div>
          <div class="form-group">
            <label>Confirm Password</label>
            <div class="input-eye">
              <input type="password" name="confirm_password" id="signup-confirm" placeholder="Repeat password" required>
              <button type="button" class="eye-btn" onclick="togglePwd('signup-confirm',this)">ğŸ‘ï¸</button>
            </div>
          </div>
          <button type="submit" class="btn-primary btn-full">Create Account</button>
        </form>
        <p class="form-switch">
          Already have an account?
          <a href="#" onclick="switchTab('login')">Log in</a>
        </p>
      </div>

      <!-- â•â• FORGOT PASSWORD FORM â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="tab-forgot" class="auth-form-wrapper {% if tab == 'forgot' %}visible{% endif %}">
        <h2 class="form-title">Reset Password ğŸ”‘</h2>
        <p class="form-subtitle">Enter your email and we'll send a reset link.</p>
        <form action="{{ url_for('auth.forgot_password') }}" method="POST" class="auth-form">
          <div class="form-group">
            <label>Email Address</label>
            <input type="email" name="email" placeholder="you@example.com" required>
          </div>
          <button type="submit" class="btn-primary btn-full">Send Reset Link</button>
        </form>
        <p class="form-switch">
          <a href="#" onclick="switchTab('login')">â† Back to Login</a>
        </p>
      </div>

      <!-- â•â• RESET PASSWORD FORM â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      {% if tab == 'reset' %}
      <div id="tab-reset" class="auth-form-wrapper visible">
        <h2 class="form-title">Set New Password ğŸ”’</h2>
        <p class="form-subtitle">Choose a strong new password for your account.</p>
        <form action="{{ url_for('auth.reset_password', token=token) }}" method="POST" class="auth-form">
          <div class="form-group">
            <label>New Password</label>
            <div class="input-eye">
              <input type="password" name="password" id="reset-pwd" placeholder="Min. 6 characters" required>
              <button type="button" class="eye-btn" onclick="togglePwd('reset-pwd',this)">ğŸ‘ï¸</button>
            </div>
          </div>
          <div class="form-group">
            <label>Confirm New Password</label>
            <div class="input-eye">
              <input type="password" name="confirm_password" id="reset-confirm" placeholder="Repeat password" required>
              <button type="button" class="eye-btn" onclick="togglePwd('reset-confirm',this)">ğŸ‘ï¸</button>
            </div>
          </div>
          <button type="submit" class="btn-primary btn-full">Update Password</button>
        </form>
      </div>
      {% endif %}

    </div><!-- /auth-right -->
  </div>

  <script>
    function switchTab(tab) {
      document.querySelectorAll('.auth-form-wrapper').forEach(el => el.classList.remove('visible'));
      document.querySelectorAll('.auth-tab').forEach(el => el.classList.remove('active'));
      document.getElementById('tab-' + tab).classList.add('visible');
      document.querySelectorAll('.auth-tab').forEach(el => {
        if (el.textContent.toLowerCase().includes(tab === 'login' ? 'log' : 'sign'))
          el.classList.add('active');
      });
    }

    function togglePwd(id, btn) {
      const inp = document.getElementById(id);
      if (inp.type === 'password') { inp.type = 'text'; btn.textContent = 'ğŸ™ˆ'; }
      else { inp.type = 'password'; btn.textContent = 'ğŸ‘ï¸'; }
    }

    // Auto dismiss flash messages
    setTimeout(() => {
      document.querySelectorAll('.flash').forEach(el => el.style.opacity = '0');
    }, 4000);
  </script>
</body>
</html>